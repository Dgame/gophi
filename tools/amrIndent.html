<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   <script>
       function amrIndent(amrIn){
           var amrOut=""
           var inLines=amrIn.split("\n");
           var level=0
           for (var i = 0; i < inLines.length; i++) {
               var line=inLines[i].trim();
               amrOut+="    ".repeat(level);
               for (var j = 0; j < line.length; j++) {
                   var c=line.charAt(j);
                   if (c==";" || c=="#"){// comment, output rest of line
                       amrOut+=line.substr(j);
                       break;
                   } else if (c=='"'){ // a string
                       var strlen=line.substr(j+1).indexOf(c);
                       if (strlen>=0){ // output string
                           amrOut+=line.substr(j,strlen+2);
                           j+=strlen+1
                       } else { // no closing quote found, output rest of line
                           amrOut+=line.substr(j)
                           break;
                       }
                   } else {
                       if (c==":" && j>0){ // start a new line at a role unless at the start
                           amrOut+="\n"+"    ".repeat(level);
                       }
                       amrOut+=c;
                       if (c=='(') level++;
                       else if (c==')') level--;
                   } 
               }
               amrOut+="\n";
           }
           return amrOut.trim();
       }
       
       console.log(amrIndent(`("Guy" m / multi-sentence  ## comment
:snt2 (w / want-01 ; un commentaire
 :arg0 (m2 / man :arg0-of (w2 / want-01 :arg1 (m3 / marry-01 :arg1 (m4 / man) "chaine non termin√©e
:arg2 (a / and 
:op1 (p / person :arg0-of (h / have-rel-role-91 :arg2 (r / relative))) 
:op2 (p2 / person :name "Marie" :surname "Je(an"
:arg0-of (h2 / have-rel-role-91 :arg1 (m5 / man) 
:arg2 (f / friend))))))) :arg1 (p3 / person :arg0-of (w3 / want-01 
:arg1 (m6 / marry-01 :arg1 (p4 / person) 
:arg2 (a2 / and :op1 (p5 / person :arg0-of (h3 / have-rel-role-91 :arg2 (r2 / relative))) 
:op2 (p6 / person :arg0-of (h4 / have-rel-role-91 :arg1 (m7 / man) :arg2 (f2 / friend))))))) 
:location (h5 / here)))
(p / pay-01 :arg0 (t / they) 
:arg1 (m / money) :arg3 (o / or :op1 (t2 / temporal-quantity :quant (N / N-A) :unit (m2 / month)) :op2 (t3 / temporal-quantity :quant (N2 / N-A) :unit (y / year))))
# un autre commentaire
`))     
   </script>
  <title>test AMRIndent</title>
</head>
<body>
  
</body>
</html>
